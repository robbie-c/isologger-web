{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","src/IsoLoggerWeb.js","isologgerweb.min.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","IsoLoggerWeb","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"AjaxJQueryOutput","opts","url","defaultOps","contentType","stringify","jQuery","method","interval","cache","currentPayload","timer","timerMultiplier","enabled","JSON","prototype","enable","_startTimer","disable","_stopTimer","setTimeout","_onTimer","bind","clearTimeout","receive","logEvent","push","concat","data","logs","ajax","type","timeout","processData","success","error","always"],"mappings":"CAAA,SAAAA,GAAA,GAAA,gBAAAC,UAAA,mBAAAC,QAAAA,OAAAD,QAAAD,QAAA,IAAA,kBAAAG,SAAAA,OAAAC,IAAAD,UAAAH,OAAA,CAAA,GAAAK,EAAAA,GAAA,mBAAAC,QAAAA,OAAA,mBAAAC,QAAAA,OAAA,mBAAAC,MAAAA,KAAAC,KAAAJ,EAAAK,aAAAV,MAAA,WAAA,MAAA,SAAAW,GAAAC,EAAAC,EAAAC,GAAA,QAAAC,GAAAC,EAAAC,GAAA,IAAAJ,EAAAG,GAAA,CAAA,IAAAJ,EAAAI,GAAA,CAAA,GAAAE,GAAA,kBAAAC,UAAAA,OAAA,KAAAF,GAAAC,EAAA,MAAAA,GAAAF,GAAA,EAAA,IAAAI,EAAA,MAAAA,GAAAJ,GAAA,EAAA,IAAAhB,GAAA,GAAAqB,OAAA,uBAAAL,EAAA,IAAA,MAAAhB,GAAAsB,KAAA,mBAAAtB,EAAA,GAAAuB,GAAAV,EAAAG,IAAAf,WAAAW,GAAAI,GAAA,GAAAQ,KAAAD,EAAAtB,QAAA,SAAAU,GAAA,GAAAE,GAAAD,EAAAI,GAAA,GAAAL,EAAA,OAAAI,GAAAF,EAAAA,EAAAF,IAAAY,EAAAA,EAAAtB,QAAAU,EAAAC,EAAAC,EAAAC,GAAA,MAAAD,GAAAG,GAAAf,QAAA,IAAA,GAAAmB,GAAA,kBAAAD,UAAAA,QAAAH,EAAA,EAAAA,EAAAF,EAAAW,OAAAT,IAAAD,EAAAD,EAAAE,GAAA,OAAAD,KAAAW,GAAA,SAAAP,EAAAjB,EAAAD,GCUA,QAAA0B,GAAAC,GACAA,EAAAA,MAEAnB,KAAAoB,IAAAD,EAAAC,KAAAC,EAAAD,IACApB,KAAAsB,YAAAH,EAAAG,aAAAD,EAAAC,YACAtB,KAAAuB,UAAAJ,EAAAI,WAAAF,EAAAE,UACAvB,KAAAwB,OAAAL,EAAAK,QAAAH,EAAAG,OACAxB,KAAAyB,OAAAN,EAAAM,QAAAJ,EAAAI,OACAzB,KAAA0B,SAAAP,EAAAO,UAAAL,EAAAK,SAEA1B,KAAA2B,SACA3B,KAAA4B,kBACA5B,KAAA6B,MAAA,KACA7B,KAAA8B,gBAAA,EAEA9B,KAAA+B,QAAA,mBAAAZ,GAAAY,QAAAZ,EAAAY,QAAAV,EAAAU,QAzBA,GAAAV,IACAD,IAAA,OACAE,YAAA,kCACAC,UAAAS,KAAAT,UACAC,OAAA,mBAAA3B,QAAAA,OAAA2B,OAAA,KACAC,OAAA,OACAC,SAAA,IACAK,SAAA,EAqBAb,GAAAe,UAAAC,OAAA,WACAlC,KAAA+B,SAAA,EACA/B,KAAAmC,eAGAjB,EAAAe,UAAAG,QAAA,WACApC,KAAA+B,SAAA,EACA/B,KAAAqC,cAGAnB,EAAAe,UAAAE,YAAA,WACAnC,KAAA+B,UAAA/B,KAAA6B,OAAA7B,KAAA2B,MAAAX,OAAA,IACAhB,KAAA6B,MAAAS,WAAAtC,KAAAuC,SAAAC,KAAAxC,MAAAA,KAAA0B,SAAA1B,KAAA8B,mBAIAZ,EAAAe,UAAAI,WAAA,WACArC,KAAA6B,QACAY,aAAAzC,KAAA6B,OACA7B,KAAA6B,MAAA,OAIAX,EAAAe,UAAAS,QAAA,SAAAC,GACA3C,KAAA2B,MAAAiB,KAAAD,GAEA3C,KAAA+B,SACA/B,KAAAmC,eAIAjB,EAAAe,UAAAM,SAAA,WAGA,GAFAvC,KAAA6B,MAAA,KAEA7B,KAAA+B,SAAA/B,KAAA2B,MAAAX,OAAA,GAAAhB,KAAAwB,OAAA,CACAxB,KAAA4B,eAAA5B,KAAA4B,eAAAiB,OAAA7C,KAAA2B,OACA3B,KAAA2B,QAEA,IAAAmB,GAAA9C,KAAAuB,WACAwB,KAAA/C,KAAA4B,iBAGA7B,EAAAC,IAEAA,MAAAwB,OAAAwB,MACAC,KAAAjD,KAAAyB,OACAqB,KAAAA,EACA1B,IAAApB,KAAAoB,IACAE,YAAAtB,KAAAsB,YACA4B,QAAA,IACAvB,OAAA,EACAwB,aAAA,IACAC,QAAA,WACArD,EAAA6B,kBACA7B,EAAA+B,gBAAA,IACAuB,MAAA,WAEAtD,EAAA+B,iBAAA,IACAwB,OAAA,WACAvD,EAAAoC,kBAKA1C,EAAAD,SACA0B,iBAAAA,aCIW,IAAI","file":"isologgerweb.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","var defaultOps = {\n  url: '/log',\n  contentType: 'application/json; charset=utf-8',\n  stringify: JSON.stringify,\n  jQuery: (typeof window !== 'undefined') ? window.jQuery : null,\n  method: 'POST',\n  interval: 10 * 1000,\n  enabled: true\n};\n\nfunction AjaxJQueryOutput(opts) {\n  opts = opts || {};\n\n  this.url = opts.url || defaultOps.url;\n  this.contentType = opts.contentType || defaultOps.contentType;\n  this.stringify = opts.stringify || defaultOps.stringify;\n  this.jQuery = opts.jQuery || defaultOps.jQuery;\n  this.method = opts.method || defaultOps.method;\n  this.interval = opts.interval || defaultOps.interval;\n\n  this.cache = [];\n  this.currentPayload = [];\n  this.timer = null;\n  this.timerMultiplier = 1;\n\n  this.enabled = (typeof opts.enabled !== 'undefined') ? opts.enabled : defaultOps.enabled;\n}\n\nAjaxJQueryOutput.prototype.enable = function enable() {\n  this.enabled = true;\n  this._startTimer();\n};\n\nAjaxJQueryOutput.prototype.disable = function enable() {\n  this.enabled = false;\n  this._stopTimer();\n};\n\nAjaxJQueryOutput.prototype._startTimer = function _startTimer() {\n  if (this.enabled && !this.timer && this.cache.length > 0) {\n    this.timer = setTimeout(this._onTimer.bind(this), this.interval * this.timerMultiplier);\n  }\n};\n\nAjaxJQueryOutput.prototype._stopTimer = function _startTimer() {\n  if (this.timer) {\n    clearTimeout(this.timer);\n    this.timer = null;\n  }\n};\n\nAjaxJQueryOutput.prototype.receive = function receive(logEvent) {\n  this.cache.push(logEvent);\n\n  if (this.enabled) {\n    this._startTimer();\n  }\n};\n\nAjaxJQueryOutput.prototype._onTimer = function _onTimer() {\n  this.timer = null;\n\n  if (this.enabled && this.cache.length > 0 && this.jQuery) {\n    this.currentPayload = this.currentPayload.concat(this.cache);\n    this.cache = [];\n\n    var data = this.stringify({\n      logs: this.currentPayload\n    });\n\n    var self = this;\n\n    this.jQuery.ajax({\n      type: this.method,\n      data: data,\n      url: this.url,\n      contentType: this.contentType,\n      timeout: 10 * 1000,\n      cache: false,\n      processData: false\n    }).success(function () {\n      self.currentPayload = [];\n      self.timerMultiplier = 1;\n    }).error(function () {\n      // back off exponentially\n      self.timerMultiplier *= 2;\n    }).always(function () {\n      self._startTimer();\n    });\n  }\n};\n\nmodule.exports = {\n  AjaxJQueryOutput: AjaxJQueryOutput\n};\n",null],"sourceRoot":"/source/"}